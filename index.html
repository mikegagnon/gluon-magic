<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Michael N. Gagnon">
    <meta name="generator" content="Hugo 0.104.2">
    <title>Gluon Magic</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.2/examples/heroes/">

    

    

<link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Favicons -->
<link rel="icon" href="img/favicon.jpg">
<meta name="theme-color" content="#712cf9">


    <style>

      .highlight {
        background-color: yellow;
      }
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

      .b-example-divider {
        height: 3rem;
        background-color: rgba(0, 0, 0, .1);
        border: solid rgba(0, 0, 0, .15);
        border-width: 1px 0;
        box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
        margin-bottom: 15px; 
      }

      .b-example-vr {
        flex-shrink: 0;
        width: 1.5rem;
        height: 100vh;
      }

      .bi {
        vertical-align: -.125em;
        fill: currentColor;
      }

      .nav-scroller {
        position: relative;
        z-index: 2;
        height: 2.75rem;
        overflow-y: hidden;
      }

      .nav-scroller .nav {
        display: flex;
        flex-wrap: nowrap;
        padding-bottom: 1rem;
        margin-top: -1px;
        overflow-x: auto;
        text-align: center;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
      }
    </style>

    
    <!-- Custom styles for this template -->
    <link href="css/heroes.css" rel="stylesheet">


  </head>
  <body>
    
<main>

    <div class="px-4 py-5 my-5 text-center">
    <h1 class="display-5 fw-bold">Gluon Magic</h1>
    <div class="col-lg-6 mx-auto">
      <p class="lead mb-4">See also: <a href="https://mikegagnon.github.io/gluon">Gluon Spoiler</a></p>

      <div id="workspace"></div>
      <div class="b-example-divider" style="margin-bottom: 40px; margin-top: 40px;"></div>

      <div>
        <center>
          Link to this page:<br>
          <div id="myqrcode"></div>
          <p style="margin-top: 100px;"><a href="index.html">Start over</a></p>
        </center>
      </div>
    </div>
  </div>

  <!--<div class="b-example-divider"></div>-->
 

</main>


    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery-3.6.3.min.js"></script>
    <script src="js/qrcode.min.js"></script>

    
    
    <script type="text/javascript">

      const SUITS = ['heart', 'diamond', 'club', 'spade'];
      const VALS = ['A', 'K', 'Q', 'J', '10', '9', '8', '7', '6', '5', '4', '3', '2', 'JR', 'JB'];

      const DECKS = [
        {
          n: 0,
          id: 'gluon_spoiler', // cannot have hyphens in deck id
          deckTop: `
            <h1>Gluon Spoiler</h1>
            <p><a href="https://mikegagnon.github.io/gluon/">Gluon Spoiler online book</a></p>
            <p>Trailer:</p>
            <iframe width="560" height="315" src="https://www.youtube.com/embed/2tBC-aHbeHg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
          cardbottomhtml:
            `<p><a href="https://mikegagnon.github.io/gluon/">Gluon Spoiler online book</a></p>
            `,
          cards: {
            'joker': {

            },
            'spade': {
              'A': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">Ace of spades</h1>
                <h3>CNWDI: Critical Nuclear Weapon Design Information</h3>

                <div style="text-align: left">

                <p style="font-size: 80%;">From the online book <a href="https://mikegagnon.github.io/gluon/index.html#i-once">Gluon Spoiler</a>:</p>
                <p class="lead mb-4">I once hacked the United States nuclear-warfare defense system, during a live-fire war game (<a href="https://mikegagnon.github.io/gluon/index.html#zbg">ZBG</a> <a href="img/zbg/zbg-233-219.jpg">pg. 219</a>).</p>

                <p class="lead mb-4">Proof that the war game was <i>live fire</i>: see pages 20 and 34 of <a href="https://www.dropbox.com/sh/w88813zihcygbze/AADd8n7FoF-O6HGd74kpiVXWa/Annual_Report_2010.pdf?dl=0">MIT Lincoln Laboratory's 2010 report</a>.
                </p>

                <img src="https://mikegagnon.github.io/gluon/img/annual.jpg" style="width:100%; margin: 30px;" alt="todo">
                

                <p class="lead mb-4">I authored an unclassified report on that war game titled <a href="https://www.dropbox.com/sh/w88813zihcygbze/AAAbKi4dPhA9DqFoyj0gbPGqa/isarcs.pdf?dl=0">Towards Net-Centric Cyber Survivability for Ballistic Missile Defense</a>.
                </div>
                `,
                bottomhtml: ``,
              },
              '2': {
                filenames: ['misc/harvard-transcript.png'],
                tophtml: `<h1 class="display-5 fw-bold">2 of spades</h1>
                <h3>Harvard</h3>

                <p style="font-size: 80%;">From <a href="https://mikegagnon.github.io/gluon/index.html#harvard">Gluon Spoiler</a> and <a href="https://mikegagnon.github.io/gluon/index.html#dbg">Deluxe Beer Garden</a></p>

                <div style="text-align: left">
                <p class="lead mb-4"><a name="harvard">I have</a> a master’s degree from Harvard. I photoshopped the photo for my student ID, before I submitted it. Lol!
                </p>
                <center>
                  <a href="https://mikegagnon.github.io/gluon/index.html#dbg"><img src="https://mikegagnon.github.io/gluon/img/harvard.jpg" style="width:100%; " alt="I actually got a perm for this photo. My smile is quirky. DBG 68. Lol, Prof. Margo Seltzer was the only one who ever commented on it. She had a roster with photos, and eventually she was like, 'Oh, that's you!' She's great. One of my favorite all-time professors."></a>
                </center>

                </div>
                `,
                bottomhtml: `
                <div style='text-align:left;'>
                <p>Here are some homework assignments I completed at Harvard:</p>
                  <ol>
                    <li><a href="https://www.dropbox.com/s/dazqbgq6zo4tfz4/algcomplex_paper.pdf?dl=0"> CS 252 Final paper: Algorithmic-Complexity Security Policies</a></li>
                    <li><a href="https://www.dropbox.com/s/6jkwbnwvt314vn1/bouncer.pdf?dl=0">Bouncer</a></li>
                    <li><a href="https://www.dropbox.com/s/dw5aw99p4rs5ip0/yamba.pdf?dl=0">Yamba</a></li>
                    <li><a href="https://www.dropbox.com/s/4am68g2e8b78hay/heliox.pdf?dl=0">Heliox</a></li>
                    <li><a href="https://www.dropbox.com/s/eg7884sftpccau8/cloud-browser.pdf?dl=0">Cloud Browser</a></li>
                    <li><a href="https://www.dropbox.com/s/7k7t5m6vqyeofzq/hw5.pdf?dl=0">CS 152, Homework Assignment 5</a></li>
                    <li><a href="https://www.dropbox.com/s/b58bs8ie0s7lp05/cs220r_mgagnon_pset1.pdf?dl=0">CS 220: Problem Set 1</a></li>
                    <li><a href="https://www.dropbox.com/s/26sriz3e3s9rywy/cs222_assignment_3_mgagnon.pdf?dl=0">CS 222, Assignment 3</a></li>
                    <li><a href="https://www.dropbox.com/s/zto7upg2hdo8gp5/commentary_due_2010_11_12.pdf?dl=0">CS 253r, Commentary on A Comparison of Software and Hardware Techniques for x86 Virtualization, 2006</a></li>
                    <li><a href="https://www.dropbox.com/s/y2s1jkwm8sgzzvb/quiz1.pdf?dl=0">CS 261, Quiz 1</a></li>
                    <li><a href="https://www.dropbox.com/s/tu2lr8u8dp36r0a/GagnonProtocol.pdf?dl=0">CS 262, GagnonProtocol</a></li>
                    <li><a href="https://www.dropbox.com/s/uviohwvzbpxi5b7/mgagnon_stat110_hw11.pdf?dl=0">Stat 110, Ultimate Homework Assignment</a></li>
                    <li><a href="https://www.dropbox.com/s/cfryon193ihw07f/hw2.pdf?dl=0">Stat 111, Homework Assignment 2</a></li>
                  </ol>
                </div>

                `,
              },
              '3': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">3 of spades</h1>
                  <h3>MIT Lincoln Laboratory</h3>

                  <p style="font-size: 80%;">From <a href="https://mikegagnon.github.io/gluon/index.html#mit-anyway">Gluon Spoiler</a> and <a href="https://mikegagnon.github.io/gluon/index.html#zbg">Zen Beer Garden</a> (see for example <a href="img/zbg/zbg-233-219.jpg">pg. 219</a>)</p>

                  <div style="text-align: left">
                    <p class="lead mb-4"><a name="mit-anyway">Anyway</a>, you might be wondering what MIT has to do with espionage and live-fire nuclear war games. I shall explain it clearly now (it’s been an open secret for a long time).<br><br>

                      Early in the Cold War the US Military and Congress collaborated to establish new private organizations controlled funded by the Federal Government and US Military. They are known as FFRDC’s (Federally Funded Research & Development Centers). Lincoln Laboratory (LL) is an FFRDC within MIT. LL is physically located within an Air Force base about 20 minutes north of MIT’s main campus.</p>


                      <p class="lead mb-4 highlight">Highlights:</p>

                      <ol>
                        <li>I worked at MIT Lincoln Laboratory for 4 years.</li>
                        <li>I designed nuclear weapons (Ace of spades)</li>
                        <li>MIT gave me a scholarship to attend Harvard (2 of spades)</li>
                        <li>I hacked a $20-billion US Army program (9 of spades)</li>
                      </ol>
                  </div>
                  `,
                bottomhtml: ``,
              },
              '4': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">4 of spades</h1>
                  <h3>Hanscom Air Force Base</h3>

                  <p style="font-size: 80%;">From <a href="https://mikegagnon.github.io/gluon/index.html#mit-anyway">Gluon Spoiler</a> and <a href="https://mikegagnon.github.io/gluon/index.html#zbg">Zen Beer Garden</a> (see for example <a href="img/zbg/zbg-233-219.jpg">pg. 219</a>)</p>

                  <div style="text-align: left">
                    <p class="lead mb-4">
                      Early in the Cold War the US Military and Congress collaborated to establish new private organizations controlled funded by the Federal Government and US Military. They are known as FFRDC’s (Federally Funded Research & Development Centers). Lincoln Laboratory (LL) is an FFRDC within MIT. LL is physically located within an Air Force base [Hanscom Air Force Base] about 20 minutes north of MIT’s main campus.</p>


                      <p class="lead mb-4 highlight">Highlights:</p>

                      <ol>
                        <li>I worked at MIT Lincoln Laboratory for 4 years.</li>
                        <li>I designed nuclear weapons (Ace of spades)</li>
                        <li>MIT gave me a scholarship to attend Harvard (2 of spades)</li>
                        <li>I hacked a $20-billion US Army program (9 of spades)</li>
                      </ol>
                  </div>
                  `,
                bottomhtml: ``,
              },
              '5': {
                filenames: ['zbg/area51.png'],
                tophtml: `<h1 class="display-5 fw-bold">5 of spades</h1>
                  <h3>Area 51</h3>

                  <p style="font-size: 80%;">From <a href="https://mikegagnon.github.io/gluon/index.html#zbg">Zen Beer Garden</a> (see <a href="img/zbg/area51.png">pg. 218</a>)</p>

                  <div style="text-align: left">
                    <p class="lead mb-4">
                      My Dad held significant responsiblity regarding Area 51. It's a matter of public record. To quote ZBG  pg. 218:
                  </div>
                  `,
                bottomhtml: `My Dad and I never discuss Area 51. Don't ask. I've tried.`,
              },
            }
          }
        },
        {
          n: 1,
          id: 'theory11',
          deckTop: `<h1>Theory 11</h1>`,
          cardbottomhtml: `
            <a href="https://www.youtube.com/channel/UCGPK6bqoOVkonz4cYpo3qBA">@mikegagnon3155</a><br>
            <a href="https://www.youtube.com/channel/UCvTCjYxkKlQNVwh8linImZQ">@alskdjflaksjdflkjsdf</a><br>
            <a href="https://www.youtube.com/channel/UClabGotXJjKeJdwhOlMI9lA">@zipinsley7365</a><br>
            <a href="https://www.youtube.com/channel/UCweluNl5hyW25RZvmzgADkw">@superhumansofboulder510</a>
            `,
          cards: {
            'joker' : {
              'JR' : {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">Red Joker</h1>
                <h3>Gluon Spoiler trailer</h3>
                <div style="text-align: left">
                <p>A trailer for my online book, <a href="https://mikegagnon.github.io/gluon/index.html">Gluon Spoiler</a>:</p>
                </div>
                `,
                bottomhtml: `
                <iframe width="560" height="315" src="https://www.youtube.com/embed/2tBC-aHbeHg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
            },
            'heart': {
              '2': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">2 of hearts</h1>
                <h3>Pink cloud crier 2</h3>
                <div style="text-align: left">
                <p>In Alcoholics Anonymous, the "pink cloud" is slang for a temporary blissful experience that sometimes comes along with an inspiring personal commitment to sobriety.</p>

                <p>I recorded this video spontaneously during a pink cloud event.</p>

                <p>This is the sequel to "Pink cloud crier" (10 of hearts).</p>
                </div>
                `,
                bottomhtml: `
                <iframe width="560" height="315" src="https://www.youtube.com/embed/cpF9z0BrMxo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
              '10': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">10 of hearts</h1>
                <h3>Pink cloud crier</h3>
                <div style="text-align: left">
                <p>In Alcoholics Anonymous, the "pink cloud" is slang for a temporary blissful experience that sometimes comes along with an inspiring personal commitment to sobriety.</p>

                <p>I recorded this video spontaneously during a pink cloud event.</p>

                <p>This is the prequel to "Pink cloud crier 2" (2 of hearts).</p>
                </div>
                `,
                bottomhtml: `
                <iframe width="560" height="315" src="https://www.youtube.com/embed/xil6Nk1dnKg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
              'J': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">Jack of hearts</h1>
                <h3>Benny & Bobby</h3>
                <div style="text-align: left">
                <p>A little story about two friends who were both really good at running.</p>
                </div>
                `,
                bottomhtml: `
                <iframe width="560" height="315" src="https://www.youtube.com/embed/SoAQBkeicOQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
            },
            'diamond': {
              'J': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">Jack of diamonds</h1>
                <h3>Young Xavier</h3>
                <div style="text-align: left">
                <p>A little metaphorical story about
                a dear friend of mine who was kissed by Cassandra (from Greek mythology).</p>
                `,
                bottomhtml: `<iframe width="560" height="315" src="https://www.youtube.com/embed/VV7WhyZTaDI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
              'A': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">Ace of diamonds</h1>
                <h3>Arcturian Gateway</h3>
                <div style="text-align: left">
                <p>
                  It was early October 2022, and my girlfriend had just dumped me outside of a dance club.
                  So, I walked to the nearest Taco Bell, and outside I met a beautiful lady. Later, on November 18, 2022, I wrote a poem about our encounter, titled <a href="https://www.shambhala.wiki/?p=15">Instant Crush</a>, which reads:</p>

                  <p style="margin-left: 30px"><i>The dakini and I met,<br>
                  Instantly we became magnets,<br>
                  She captured my phone,<br>
                  Punched in some keys,<br>
                  Said goodbye,<br>
                  It lasted ~30 seconds.</i></p>

                  <p>We had a date the next day, and we kept hanging out after that.</p>

                  <p>Then, we spent 3 whole days together, from October 17 through October 19.</p>

                  <p>This timing was auspicious because, according to various sources, Earth was
                  passing through an "Arcturian gateway portal" during that time window.</p>

                  <p>I recorded some of our adventures during the portal, and mixed in some old footage
                  of other, previous adventures I had particpated in, then uploaded it to YouTube.</p>
                `,
                bottomhtml: `<iframe width="560" height="315" src="https://www.youtube.com/embed/InWPYCGolXM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
            },
            'club': {
              'J': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">Jack of clubs</h1>
                <h3>Tedla:</h3>
                <h3>The Adventures of Trickstergod and the Megababes, Volume 1</h3>
                <div style="text-align: left">
                <p>A fictional little comic-book reading featuring a story about a fictional Buddhist "god."
                </p>

                <p>The term "gods," in Buddhism, refers to beings that suffer neurosis, yet are powerful.
                There's a lot more to it than that. See Section 8.1.5 of my book <a href="https://mikegagnon.github.io/gluon/index.html#auspicious">Auspicious Doubt</a> for a discussion of the concept of "gods" within Buddhism.</p>
                </div>
                `,
                bottomhtml: `
                <iframe width="560" height="315" src="https://www.youtube.com/embed/_nEke32vGBY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
            },
            'spade': {
              '2': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">2 of spades</h1>
                <h3>Dragon Guardian</h3>
                <div style="text-align: left">

                <p>There's a lady who I have nicknamed The Dakini (see Ace of diamonds).</p>

                <p>When I launched Shambhala.wiki on Nov. 18, 2022, I asked her what we should
                post. She said, "An infinity symbol," so I did it, <a href="https://www.shambhala.wiki/?p=5">see</a>.

                <p>Anyway, one night, recently, we were communicating with each other via spontaneously
                recorded videos, sent via text. But, one video I recorded was really long, so I uploaded
                it to YouTube, and sent her a private link. But, the next day, I decided to make
                the video public.</p>

                <p>The video "Dragon Guardian" features a spontaneous reading of one of my latest books,
                <a href="https://mikegagnon.github.io/gluon/index.html#kgems">The World According to Kindergarten Gems</a>, and I also discuss a Buddhist meditation I've nicknamed "transposition," which is discussed in my book <a href="https://mikegagnon.github.io/gluon/index.html#trans">The Gentle Way of War</a>.</p>
                </div>

                `,
                bottomhtml: `
                <iframe width="560" height="315" src="https://www.youtube.com/embed/xkUAc6SlgUk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
              '7': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">7 of spades</h1>
                <h3>Spoof stealth sousveillance introduction</h3>
                <div style="text-align: left">

                <p><i>Sousveillance</i> is when "ordinary people"  surveill the powers.</p>

                <p><i>Stealth sousveillance</i> is when "ordinary people" <i>stealthily</i> surveill the powers.</p>
                <p><i>Spoof stealth sousveillance</i> is when "ordinary people" <i>trick</i> the powers into thinking they're being stealthily sousveilled, but really there's no stealth sousveillance.</p>

                <p>I believe spoof stealth sousveillance is easier than stealth sousveillance, and, if implemented widely, it ought to pressure the powers into behaving better. (Real sousveillance, including stealth sousveillance are important, too.)</p>

                <p>This video also serves as the introductory portion of "gmike rambling thoughts" (King of spades)</p>
                </div>

                `,
                bottomhtml: `
                <iframe width="560" height="315" src="https://www.youtube.com/embed/E3e0Uw7N60M" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
              'J': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">Jack of spades</h1>
                <h3> Pan and Tinkerbell</h3>
                <p>A children's story not suitable for children (PG-14).</p>
                `,
                bottomhtml: `
                <iframe width="560" height="315" src="https://www.youtube.com/embed/VRW6P6HxKSM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
              'K': {
                filenames: [],
                tophtml: `<h1 class="display-5 fw-bold">King of spades</h1>
                <h3>gmike rambling thoughts</h3>
                <p style="text-align: left">An hour long "video podcast" of me just opening my mouth, and allowing myself to 
                spontaneously share my thoughts with the world, with very little self censorship.</p>
                `,
                bottomhtml: `
                <iframe width="560" height="315" src="https://www.youtube.com/embed/S7DOb539UeA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`,
              },
            },
          }
        }
      ];

      let BASE;
      function setBase() {
        const i = window.location.href.indexOf('?');
        if (i < 0) {
          BASE = window.location.href;
        } else {
          BASE = window.location.href.slice(0, i);
        }
        console.log('BASE', BASE);
      }


      let DECK;
      let DECK_I;
      let CARDS;
      let URL_PARTS;

      // https://davidshimjs.github.io/qrcodejs/
      const QRCODE = new QRCode("myqrcode", {
          text: window.location.href,
          width: 256,
          height: 256,
          colorDark : "#000000",
          colorLight : "#ffffff",
          correctLevel : QRCode.CorrectLevel.L
      });


      function drawDeckSelector(deckI) {
        let divider = '';
        if (deckI > 0) {
          divider = '<div class="b-example-divider"></div>';
        }
        const html = `
          <div id="decks-${deckI}" class="not-init">
            ${divider}
            <p><button type="button" class="deck btn btn-primary btn-lg px-4 gap-3" onclick="deckClick(0)">Gluon Spoiler</button></p>
            <p><button type="button" class="deck btn btn-primary btn-lg px-4 gap-3" onclick="deckClick(1)">Theory 11</button></p>
          </div>
          <div id="deckTop-${deckI}" class="not-init">
          </div>
          <div id="cards-${deckI}" class="not-init">
          </div>`;
        $("#workspace").append(html);

      }

      

      // https://stackoverflow.com/questions/8038726/how-to-trigger-change-when-using-the-back-button-with-history-pushstate-and-pops
      function change(state) {
          if(state === null) { // initial page
              //$("div").text("Original");
              console.log('initial')
              initialize();
          } else { // page added with pushState
              console.log(state.url);
              initialize();
          }
      }
      $(window).on("popstate", function(e) {
          change(e.originalEvent.state);
      });



      


      class CardSelector {
        constructor(n) {
          CARDS.push(this);
          this.n = n;
          this.id = "card-selector-" + this.n;
          console.log(`#cards-${DECK_I}`);
          if (this.n > 0 || this.n === 0) {
            $(`#cards-${DECK_I}`).append(`
              <div class="not-init end-button" style="margin-bottom: 10px;">
                <button type="button" class="end-btn btn btn-outline-secondary btn-lg px-4 gap-3" onclick="endDeck(${this.n})">End deck</button>
              </div>
            `);
          }

          $(`#cards-${DECK_I}`).append(`

      <div class="not-init" id="${this.id}">
        <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
          <p>
            <button type="button" class="suit suit-heart btn btn-danger btn-lg px-4 gap-3" onclick="suitClick(${this.n}, 'heart')">♥</button>
            <button type="button" class="suit suit-diamond btn btn-danger btn-lg px-4 gap-3" onclick="suitClick(${this.n}, 'diamond')">♦</button>
            <button type="button" class="suit suit-club btn btn-dark btn-lg px-4 gap-3" onclick="suitClick(${this.n}, 'club')">♣</button>
            <button type="button" class="suit suit-spade btn btn-dark btn-lg px-4 gap-3" onclick="suitClick(${this.n}, 'spade')">♠</button>
          </p>
        </div>
      </div>`);

          //this.disableSuit(DECK_I, 'club');
          const deck = DECK;
          for (const suit of SUITS) {
            if (!(suit in deck.cards)) {
              this.disableSuit(DECK_I, suit);
            } 
          }

        }

        disableSuit(deckI, suit) {

          $(`#cards-${deckI} .suit-${suit}`).attr('disabled', true);
          $(`#cards-${deckI} .suit-${suit}`).removeClass('btn-danger');
          $(`#cards-${deckI} .suit-${suit}`).removeClass('btn-dark');
          $(`#cards-${deckI} .suit-${suit}`).css('border', '0px');

        }

        suitClick(suit) {
          this.suit = suit;
          $(`#${this.id} .suit`).removeClass('btn-danger');
          $(`#${this.id} .suit`).removeClass('btn-dark');
          $(`#${this.id} .suit`).attr('disabled', 'true');
          $(`#${this.id} .suit`).css('border', '0px');
          $(`.end-btn`).css('border', '0px');
          $(`.end-btn`).attr('disabled', true);
          if (suit === 'heart' || suit === 'diamond') {
            $(`#${this.id} .suit-${suit}`).addClass('btn-danger');
          } else {
            $(`#${this.id} .suit-${suit}`).addClass('btn-dark');
          }
          $(`#${this.id}`).append(`

        <div class="justify-content-sm-center not-init">
          <p>
            <button type="button" class="val val-A btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 'A')">A</button>
            <button type="button" class="val val-K btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 'K')">K</button>
            <button type="button" class="val val-Q btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 'Q')">Q</button>
            <button type="button" class="val val-J btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 'J')">J</button>
          </p>
          <p>
            <button type="button" class="val val-10 btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 10)">10</button>
            <button type="button" class="val val-9 btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 9)">9</button>
            <button type="button" class="val val-8 btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 8)">8</button>
            <button type="button" class="val val-7 btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 7)">7</button>
          </p>
          <p>
            <button type="button" class="val val-6 btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 6)">6</button>
            <button type="button" class="val val-5 btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 5)">5</button>
            <button type="button" class="val val-4 btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 4)">4</button>
            <button type="button" class="val val-3 btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 3)">3</button>
            <button type="button" class="val val-2 btn btn-warning btn-lg px-4 gap-3" onclick="valClick(${this.n}, 2)">2</button>
          </p>
          <p>
            <button type="button" class="val val-JR btn btn-danger btn-lg px-4 gap-3" onclick="valClick(${this.n}, 'JR')">Joker</button>
            <button type="button" class="val val-JB btn btn-dark btn-lg px-4 gap-3" onclick="valClick(${this.n}, 'JB')">Joker</button>
          </p>
        </div>`);

          const deck = DECK;
          for (const val of VALS) {
            if (!(val in deck.cards[this.suit])) {
              if ((val === 'JR' || val === 'JB')) {
                if (!(val in deck.cards['joker'])) {
                  this.disableVal(val);
                }
                // pass
              } else {
                this.disableVal(val);
              }
            } 
          }
        }

        disableVal(val) {
          $(`#${this.id} .val-${val}`).attr('disabled', true);
          $(`#${this.id} .val-${val}`).removeClass('btn-warning');
          $(`#${this.id} .val-${val}`).removeClass('btn-danger');
          $(`#${this.id} .val-${val}`).removeClass('btn-dark');
          $(`#${this.id} .val-${val}`).css('border', '0px');

        }

        valClick(val) {
          this.val = val;
          let suit = this.suit;
          if (this.val === 'JR' || this.val === 'JB') {
            suit = 'joker';
          }

          $(`#${this.id} .val`).removeClass('btn-warning');
          $(`#${this.id} .val`).attr('disabled', 'true');
          $(`#${this.id} .val`).css('border', '0px');
          $(`#${this.id} .val-${this.val}`).addClass('btn-warning');

          const deck = DECK;
          console.log(this.val);
          const c = deck.cards[suit][this.val];
          
          $(`#${this.id}`).append(c.tophtml);
          const mar = "15px;"

          for (const f of c.filenames) {
            $(`#${this.id}`).append(`
              <a href="img/${f}"><img class="rounded shadow" style="width:100%; padding-top: ${mar}; padding-left: ${mar}; padding-right: ${mar}; padding-bottom: ${mar}; margin-bottom: ${mar}" src="img/${f}"></a>
            `); 
          }

          $(`#${this.id}`).append(c.bottomhtml);
          $(`#${this.id}`).append(deck.cardbottomhtml);

          const cardN = CARDS.length;
          const cardSelector = new CardSelector(cardN);


        }

        endDeck() {
          $(`.end-btn`).css('border', '0px');
          $(`.end-btn`).attr('disabled', true);
          $(`.suit`).removeClass('btn-danger');
          $(`.suit`).removeClass('btn-dark');
          $(`.suit`).attr('disabled', 'true');
          $(`.suit`).css('border', '0px');
        }
      }

      function updateUrl() {
        const q = URL_PARTS.join('');
        // https://stackoverflow.com/questions/4656843/get-querystring-from-url-using-jquery
        

        const newUrl = BASE + '?' + q;
        console.log('updateUrl base', BASE);
        console.log('updateUrl newUrl', newUrl);

        //window.location.href = newUrl;
        //window.history.pushState("object or string", "Title", "/new-url");
        window.history.pushState({}, '', newUrl);

        QRCODE.clear(); // clear the code.
        QRCODE.makeCode(newUrl);
      }


      function deckClick(n, noUpdateUrl) {
          DECK = DECKS[n];
          console.log('DECK_I', DECK_I)
          $('.deck').css('color', 'rgb(108, 117, 125)');
          
          $(`#decks-${DECK_I} button`).attr('disabled', true);
          $(`#decks-${DECK_I} button`).removeClass('btn-primary');
          $(`#decks-${DECK_I} button`).attr('disabled', true);
          $(`#decks-${DECK_I} button`).addClass('btn-light');
          $(`#decks-${DECK_I} button`).eq(n).removeClass('btn-light');
          $(`#decks-${DECK_I} button`).eq(n).addClass('btn-primary');
          $(`.btn-primary`).css('color', 'white');

          const cardN = CARDS.length;
          const cardSelector = new CardSelector(cardN);
          //console.log(cardSelector);
          let deckId;
          if (DECK_I === 0) {
            deckId = DECK.id
          } else {
            deckId = "-" + DECK.id;
          }
          URL_PARTS.push(deckId);
          if (!noUpdateUrl) {
            updateUrl();
          }
          console.log(URL_PARTS);

          $(`#deckTop-${DECK_I}`).append(DECK.deckTop);

      }

      function suitClick(n, suit, noUpdateUrl) {
        const card = CARDS[n];
        //console.log(card.id, suit);
        card.suitClick(suit);
        URL_PARTS.push('-' + suit);
        console.log("suitClick DECK_I", DECK_I);
        if (!noUpdateUrl) {
          //updateUrl();
        }
      }

      function valClick(n, val, noUpdateUrl) {
        const card = CARDS[n];
        card.valClick(val);
        URL_PARTS.push('_' + val);

        if (!noUpdateUrl) {
          updateUrl();
        }
      }

      function endDeck(n, noUpdateUrl) {
        const card = CARDS[n];
        card.endDeck();


        DECK_I++;
        drawDeckSelector(DECK_I);



        URL_PARTS.push('-end');
        console.log('END:', URL_PARTS)

        if (!noUpdateUrl) {
          updateUrl();
        }
      }

      function getDeckN(deckName) {
        for (const d of DECKS) {
          if (d.id === deckName) {
            return d.n;
          }
        }
        return -1;
      }

      function loadDeck(parts, deckI, cardI) {
        if (parts.length < 1) {
          console.error('Missing deck name from', parts);
          return [[], undefined];
        }
        const deckName = parts.shift();
        console.log('deckName', deckName);

        const deckN = getDeckN(deckName);
        if (deckN < 0) {
          console.error('Could not find deck', deckName);
          return [[], undefined];
        }
        console.log('Clicking deck', deckName);
        deckClick(deckN, true);

        while (true) {
          if (parts.length === 0) {
            return [[], undefined];
          }
          const head = parts.shift();
          if (head === 'end') {
            console.log('Clicking end', deckName, parts, cardI);

            endDeck(cardI, true);
            cardI++;

            return [parts, cardI];
          }

          const c = head.split('_');
          if (c.length !== 2) {
            console.error('Could not parse card', c);
            return [[], undefined];
          }
          const [suit, val] = c;
          if (!SUITS.includes(suit)) {
            console.error('Bad suit', c);
            return [[], undefined];
          }
          if (!VALS.includes(val)) {
            console.error('Bad val', c);
            return [[], undefined];
          }

          console.log('Clicking', cardI, suit, val);

          suitClick(cardI, suit, true);
          valClick(cardI, val, true);
          cardI++;
        }
        return [parts, cardI];
      }

      function parseUrl(i) {
          const params = window.location.href.slice(i + 1).split('&');
          if (params.length !== 1) {
            console.log('params.length !== 1=== ', params.length);
            return;
          }
          const p = params[0];
          let parts = p.split('-');
          let deckI = 0;
          let cardI = 0;

          while (parts.length > 0) {
            [parts, cardI] = loadDeck(parts, deckI, cardI);
            deckI++;
          }
      }


      function main() {
          // https://stackoverflow.com/questions/4656843/get-querystring-from-url-using-jquery
          const i = window.location.href.indexOf('?');
          if (i >= 0) {
            parseUrl(i);
          }
      }


      setBase();

      function initialize() {
        console.log('initialize');
        $(".not-init").remove();
        DECK = undefined;
        CARDS = [];
        URL_PARTS = [];
        DECK_I = 0;
        drawDeckSelector(DECK_I);
        main();
      }

      initialize();

      
      

    </script>

    <script type="text/javascript">
    </script>

      
  </body>
</html>
